<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>
    <title>Expense material dashboard</title>
    <link rel="icon" href="logo2.png">
    <meta name="theme-color" content="#44ac67">
    <style>
            .footer-distributed {
    border-radius: 00px;
  background-color: #ffffff;
  box-shadow: 0 1px 1px 0 rgba(0, 0, 0, 0.12);
  box-sizing: border-box;
  width: 100%;
  text-align: left;
  border-top: 0.2px solid rgb(206, 206, 206);
  font: normal 16px sans-serif;
  padding: 45px 50px;
}
.copy{
    background: -webkit-linear-gradient(90deg, rgb(33, 155, 43) 50%, rgb(7, 110, 12) 100%) !important;
            -webkit-background-clip: text !important;
            -webkit-text-fill-color: transparent !important;
}
.footer-distributed .footer-left p {
  color: #8f9296;
  font-size: 14px;
  margin: 0;
}
/* Footer links */

.footer-distributed p.footer-links {
  font-size: 18px;
  font-weight: bold;
  color: #33383b;
  margin: 0 0 10px;
  padding: 0;
  transition: ease .25s;
}

.footer-distributed p.footer-links a {
  display: inline-block;
  line-height: 1.8;
  text-decoration: none;
  color: inherit;
  transition: ease .25s;
}

.footer-distributed .footer-links a:before {
  content: "·";
  font-size: 20px;
  left: 0;
  color: #616161;
  display: inline-block;
  padding-right: 5px;
}

.footer-distributed .footer-links .link-1:before {
  content: none;
}

.footer-distributed .footer-right {
  float: right;
  margin-top: 6px;
  max-width: 180px;
}

.footer-distributed .footer-right a {
  display: inline-block;
  width: 35px;
  height: 35px;
  background-color: #33383b;
  border-radius: 2px;
  font-size: 20px;
  color: #ffffff;
  text-align: center;
  line-height: 35px;
  margin-left: 3px;
  transition:all .25s;
}

.footer-distributed .footer-right a:hover{transform:scale(1.1); -webkit-transform:scale(1.1);}

.footer-distributed p.footer-links a:hover{text-decoration:underline;}

/* Media Queries */

@media (max-width: 600px) {
  .footer-distributed .footer-left, .footer-distributed .footer-right {
    text-align: center;
  }
  .footer-distributed .footer-right {
    float: none;
    margin: 0 auto 20px;
  }
  .footer-distributed .footer-left p.footer-links {
    line-height: 1.8;
  }
}
      body ,html{
        width: 100%;
        height: 100%;
        margin: 0px;
        padding: 0px;
        background-image: url("back.png"); 
        background-repeat: no-repeat;
      }
      @media screen and (max-width:750px)  {
        #page{
          width: 100% !important;
        }
      }
      #page{
        width: 70%;
        padding: 10px;
      }
      table{
        width: 100%;
      }
    th{
        padding: 10px;
    }
    td{
        padding: 10px;
        outline: none;
    }
    td, th {
        border: 1px solid #c9c9c9;
        text-align: left;
        padding: 8px;
    }

    tr:nth-child(even) {
      background: rgb(178,255,195);
      background: linear-gradient(90deg, rgb(206, 255, 216) 0%, rgba(222,255,220,1) 100%);
    }
    a{
          text-decoration: none;
        }
        .cus{
        padding: 8px;
        width: 190px;
        text-align: center;
        border: 0.4px solid rgb(68, 68, 68);
        border-radius: 50px;
        right: 10px;
        
        justify-content: right; 
        text-decoration: none;
        transition: 0.2s;
    }
    </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-light bg-white p-2 fixed-top" style="box-shadow: 0px 5px 10px -5px rgb(199, 206, 211); ">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">
        <img src="logo.png" alt="" width="150"  class="d-inline-block align-text-top">
        </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item" >
            <a class="nav-link"   aria-current="page" href="index.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://porbet.github.io/opensource/contact.html">Contact</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://porbet.github.io/opensource/privacy.html">Privacy Policy</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Social media
            </a>
            <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
              <li><a class="dropdown-item" href="https://www.instagram.com/porbe_t/">Instagram</a></li>
              <li><a class="dropdown-item" href="https://www.youtube.com/channel/UCCjx1r99pZxmtfVVF8tF48Q">Youtube</a></li>
              <li><a class="dropdown-item" href="https://github.com/Adil-production">Github</a></li>
            </ul>
          </li>
        </ul>
        <li class="d-flex nav-item " >
                      
          <a class="nav-link cus" style="color: rgb(68, 68, 68);" href="dashboard2.html">
            <svg xmlns="http://www.w3.org/2000/svg" style="transform: translateY(-8%); margin-right: 10px; color:rgb(46, 80, 46)" width="20" height="20" fill="currentColor" class="bi bi-file-earmark-spreadsheet" viewBox="0 0 16 16">
              <path d="M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2zM9.5 3A1.5 1.5 0 0 0 11 4.5h2V9H3V2a1 1 0 0 1 1-1h5.5v2zM3 12v-2h2v2H3zm0 1h2v2H4a1 1 0 0 1-1-1v-1zm3 2v-2h3v2H6zm4 0v-2h3v1a1 1 0 0 1-1 1h-2zm3-3h-3v-2h3v2zm-7 0v-2h3v2H6z"/>
            </svg>
            Import XLSX file
          </a>
      </li>
      </div>
    </div>
  </nav>
      <br>
      <br>
      <br>
      <br>
      <h1 style="color: #3c995b; margin: 20px;"><strong>Hello,</strong> <span id="name"></span></h1>
      <br>
      <br>
      <nav class="nav nav-pills justify-content-center m-3">
        <a class="nav-link text-success" aria-current="page" href="clientDashboard.html">Client</a>
        <a class="nav-link text-success" href="supplierDashboard.html">Suppliers</a>
        <a class="nav-link active bg-success" href="materialDashboard.html">Materials</a>
      </nav>
      <br>

<div align="center">
<div id="page" align="left">
      <div align="right">
        <button class="btn btn-success m-2" style="display: inline-block;" id="add">Add new row</button><button class="btn btn-outline-success m-2" style="display: inline-block;" id="workontable" onclick="parse()">Work on table</button>
        <button class="btn btn-success m-2" style="display: none;" id="recreate">Recreate table</button><button class="btn btn-outline-success m-2" style="display: none;" id="add2">Add new row</button>
      </div>
      <br>
      <br>
      <div id="informations">
      <h3 style="color: black; font-weight: bold;"><span>Article code</span></h3>
      <br>
      <div id="articleCode" align="center">
        <div class="form-floating mb-3">
          <input type="text"  class="form-control" name="articleCodeValue"  value="">
          <label for="floatingInput">Article code</label>
        </div>
        <br>
      </div>


      <br>
      <br>
      <h3 style="color: black; font-weight: bold;"><span>Category</span></h3>
      <br>
      <div id="category" align="center">
        <div class="form-floating mb-3">
          <input type="text"  class="form-control" name="categoryValue"  value="">
          <label for="floatingInput">Category</label>
        </div>
        <br>
      </div>



      <br>
      <br>
      <h3 style="color: black; font-weight: bold;"><span>Subject Name</span></h3>
      <br>
      <div id="subjectName" align="center">
        <div class="form-floating mb-3 ">
          <input type="text"  class="form-control" name="subjectNameValue"  value="">
          <label for="floatingInput">Subject Name</label>
        </div>
        <br>
      </div>




      <br>
      <br>
      <h3 style="color: black; font-weight: bold;"><span>Unit (Kg)</span></h3>
      <br>
      <div id="unit" align="center">
        <div class="form-floating mb-3 ">
          <input type="text"  class="form-control" name="unitValue"  value="">
          <label for="floatingInput">Unit</label>
        </div>
        <br>
      </div>




      <br>
      <br>
      <h3 style="color: black; font-weight: bold;"><span>Single price</span></h3>
      <br>
      <div id="singlePrice" align="center">
        <div class="form-floating mb-3 ">
          <input type="text"  class="form-control" name="singlePriceValue"  value="">
          <label for="floatingInput">Single price</label>
        </div>
        <br>
      </div>






      <br>
      <br>
      <h3 style="color: black; font-weight: bold; "><span>Entries</span></h3>
      <br>
      <div id="entries" align="center">
        <div class="form-floating mb-3">
          <input type="text"  class="form-control" name="entriesValue"  value="">
          <label for="floatingInput">Entries</label>
        </div>
        <br>
      </div>







      <br>
      <br>
      <h3 style="color: black; font-weight: bold;"><span>Outputs</span></h3>
      <br>
      <div id="outputs" align="center">
        <div class="form-floating mb-3 ">
          <input type="text"  class="form-control" name="outputsValue"  value="">
          <label for="floatingInput">Outputs</label>
        </div>
        <br>
      </div>




      
      <br>
      <br>
      <h3 style="color: black; font-weight: bold;"><span>Existing</span></h3>
      <br>
      <div id="existing" align="center">
        <div class="form-floating mb-3 ">
          <input type="text"  class="form-control" name="existingValue"  value="">
          <label for="floatingInput">Existing</label>
        </div>
        <br>
      </div>







      <div align="right">
        <br>
        <button class="btn btn-success" id="parse" onclick="parse()">Parse</button>
      </div>

</div>
</div>
</div>




      <div id="tableEx">

      </div>

        <br>
        <br>
        <div align="right" id="install" style="display: none;" class="m-3">
          <button class="btn btn-outline-success m-2" id="save">Save</button><button class="btn btn-success m-2" id="download" onclick="ExportToExcel('xlsx')">Download Excel file</button>
        </div>

        <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <footer class="footer-distributed">

    <div class="footer-right">
        
        <img src="logo.png" width="150px">

    </div>

    <div class="footer-left">

        <p class="footer-links">
            <a class="link-1" href="index.html">Home</a>

            <a href="about.html">About us</a>

            <a href="https://porbet.github.io/contact.html">Contact us</a>
        </p>

        <p class="copy" style="font-weight:bold ;" >Made with ♥ by Porbet © 2023</p>
    </div>
</footer>
      <script>
        document.getElementById("name").innerHTML = localStorage.getItem("name");

        // Add new row
        document.getElementById("add").addEventListener("click",function(){
          document.getElementById("articleCode").innerHTML += `
          <div class="form-floating mb-3">
            <input type="text"  class="form-control" name="articleCodeValue"  value="">
            <label for="floatingInput">Article code</label>
          </div>
          <br>
          `
          document.getElementById("category").innerHTML += `
          <div class="form-floating mb-3">
            <input type="text"  class="form-control" name="categoryValue"  value="">
            <label for="floatingInput">Category</label>
          </div>
          <br>
          `
          document.getElementById("subjectName").innerHTML += `
          <div class="form-floating mb-3 ">
            <input type="text"  class="form-control" name="subjectNameValue"  value="">
            <label for="floatingInput">Subject Name</label>
          </div>
          <br>
          `
          document.getElementById("unit").innerHTML += `
          <div class="form-floating mb-3 ">
            <input type="text"  class="form-control" name="unitValue"  value="">
            <label for="floatingInput">Unit</label>
          </div>
          <br>
          `
          document.getElementById("singlePrice").innerHTML += `
          <div class="form-floating mb-3 ">
            <input type="text"  class="form-control" name="singlePriceValue"  value="">
            <label for="floatingInput">Single price</label>
          </div>
          <br>
          `
          document.getElementById("entries").innerHTML += `
          <div class="form-floating mb-3">
            <input type="text"  class="form-control" name="entriesValue"  value="">
            <label for="floatingInput">Entries</label>
          </div>
          <br>
          `
          document.getElementById("outputs").innerHTML += `
          <div class="form-floating mb-3 ">
            <input type="text"  class="form-control" name="outputsValue"  value="">
            <label for="floatingInput">Outputs</label>
          </div>
          <br>
          `
          document.getElementById("existing").innerHTML += `
          <div class="form-floating mb-3 ">
            <input type="text"  class="form-control" name="existingValue"  value="">
            <label for="floatingInput">Existing</label>
          </div>
          <br>
          `
        })

        function parse(){
          var articleCode = document.getElementsByName('articleCodeValue');
          var category = document.getElementsByName('categoryValue');
          var subjectName = document.getElementsByName('subjectNameValue');
          var unit = document.getElementsByName('unitValue');
          var singlePrice = document.getElementsByName('singlePriceValue');
          var entries = document.getElementsByName('entriesValue');
          var outputs = document.getElementsByName('outputsValue');
          var existing = document.getElementsByName('existingValue');
          var articleCodeValue = [];
          var categoryValue = [];
          var subjectNameValue = [];
          var unitValue = [];
          var singlePriceValue = [];
          var entriesValue = [];
          var outputsValue = [];
          var existingValue = [];
          for (var i = 0; i < articleCode.length; i++) {
              var a = articleCode[i].value;
              articleCodeValue.push(a);
          }
          for (var i = 0; i < category.length; i++) {
              var a = category[i].value;
              categoryValue.push(a);
          }
          for (var i = 0; i < subjectName.length; i++) {
              var a = subjectName[i].value;
              subjectNameValue.push(a);
          }
          for (var i = 0; i < unit.length; i++) {
              var a = unit[i].value;
              unitValue.push(a);
          }
          for (var i = 0; i < singlePrice.length; i++) {
              var a = singlePrice[i].value;
              singlePriceValue.push(a);
          }
          for (var i = 0; i < entries.length; i++) {
              var a = entries[i].value;
              entriesValue.push(a);
          }
          for (var i = 0; i < outputs.length; i++) {
              var a = outputs[i].value;
              outputsValue.push(a);
          }
          for (var i = 0; i < existing.length; i++) {
              var a = existing[i].value;
              existingValue.push(a);
          }

          console.log(articleCodeValue);
          console.log(categoryValue);
          console.log(subjectNameValue);
          console.log(unitValue);
          console.log(singlePriceValue);
          console.log(entriesValue);
          console.log(outputsValue);
          console.log(existingValue);

        var customers = new Array();
        customers.push(["Article code", "Category", "Subject name", "Unit (kg)", "Single price", "Entries", "Outputs" , "Existing"]);
        for(var i = 0; i < outputsValue.length; i++){
          customers.push([articleCodeValue[i], categoryValue[i] , subjectNameValue[i], unitValue[i], singlePriceValue[i], entriesValue[i], outputsValue[i] , existingValue[i] ]);
        }
        //Create a HTML Table element.
        var table = document.createElement("TABLE");
        table.setAttribute("id","table");
        table.border = "1";
 
        //Get the count of columns.
        var columnCount = customers[0].length;
 
        //Add the header row.
        var row = table.insertRow(-1);
        for (var i = 0; i < columnCount; i++) {
            var headerCell = document.createElement("TH");
            headerCell.innerHTML = customers[0][i];
            row.appendChild(headerCell);
        }
 
        //Add the data rows.
        for (var i = 1; i < customers.length; i++) {
            row = table.insertRow(-1);
            for (var j = 0; j < columnCount; j++) {
                var cell = row.insertCell(-1);
                cell.contentEditable = "true";
                cell.innerHTML = customers[i][j];
            }
        }
 
        var dvTable = document.getElementById("tableEx");
        dvTable.innerHTML = "";
        dvTable.appendChild(table);
        localStorage.setItem("materialTable",document.getElementById("tableEx").innerHTML)



        document.getElementById("informations").style.display = "none";
        document.getElementById("add").style.display = "none";
        document.getElementById("workontable").style.display = "none";
        document.getElementById("recreate").style.display = "inline-block";
        document.getElementById("add2").style.display = "inline-block";
        document.getElementById("install").style.display = "block";

      
        }
        //recreate table
        document.getElementById("recreate").addEventListener("click",function(){
          localStorage.removeItem("materialTable");
          window.location.reload();
        })
        //save table
        document.getElementById("save").addEventListener("click",function(){
          localStorage.setItem("materialTable",document.getElementById("tableEx").innerHTML)
          alert("Saved")
        })
        //add new row table
        document.getElementById("add2").addEventListener("click",function(){
          document.getElementsByTagName("tbody")[0].innerHTML += `
              <tr>
                <td contentEditable="true"></td>
                <td contentEditable="true"></td>
                <td contentEditable="true"></td>
                <td contentEditable="true"></td>
                <td contentEditable="true"></td>
                <td contentEditable="true"></td>
                <td contentEditable="true"></td>
                <td contentEditable="true"></td>
              </tr>
          `
        })



      window.addEventListener('load', (event) => {
          var table = localStorage.getItem("materialTable")
          if(table){
            document.getElementById("informations").style.display = "none";
            document.getElementById("add").style.display = "none";
            document.getElementById("workontable").style.display = "none";
            document.getElementById("tableEx").innerHTML = table;
            document.getElementById("recreate").style.display = "inline-block";
            document.getElementById("add2").style.display = "inline-block";
            document.getElementById("install").style.display = "block";
          } else{
            document.getElementById("informations").style.display = "block";
            document.getElementById("add").style.display = "inline-block";
            document.getElementById("workontable").style.display = "inline-block";
            document.getElementById("recreate").style.display = "none";
            document.getElementById("add2").style.display = "none";
            document.getElementById("install").style.display = "none";
          }
        }); 

        function ExportToExcel(type, fn, dl) {
            var elt = document.getElementById('table');
            var wb = XLSX.utils.table_to_book(elt, { sheet: "material" });
            return dl ?
              XLSX.write(wb, { bookType: type, bookSST: true, type: 'base64' }):
              XLSX.writeFile(wb, fn || (localStorage.getItem("company") + ' material.' + (type || 'xlsx')));
        }


      </script>
</body>
</html>
