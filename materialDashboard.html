<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>
    <title>Expense material dashboard</title>
    <link rel="icon" href="logo2.png">
    <meta name="theme-color" content="#44ac67">
    <style>
      body ,html{
        width: 100%;
        height: 100%;
        margin: 0px;
        padding: 0px;
      }
      @media screen and (max-width:750px)  {
        #page{
          width: 100% !important;
        }
      }
      #page{
        width: 70%;
        padding: 10px;
      }
      table{
        width: 100%;
      }
    th{
        padding: 10px;
    }
    td{
        padding: 10px;
        outline: none;
    }
    td, th {
        border: 1px solid #dbdbdb;
        text-align: left;
        padding: 8px;
    }

    tr:nth-child(even) {
        background-color: #dbffd8;
    }
    a{
          text-decoration: none;
        }
    </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-light bg-white p-2 fixed-top" style="box-shadow: 0px 5px 10px -5px rgb(199, 206, 211);">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">
        <img src="logo.png" alt="" width="150"  class="d-inline-block align-text-top">
        </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item" >
            <a class="nav-link"   aria-current="page" href="index.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://porbet.github.io/opensource/contact.html">Contact</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://porbet.github.io/opensource/privacy.html">Privacy Policy</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Social media
            </a>
            <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
              <li><a class="dropdown-item" href="https://www.instagram.com/porbe_t/">Instagram</a></li>
              <li><a class="dropdown-item" href="https://www.youtube.com/channel/UCCjx1r99pZxmtfVVF8tF48Q">Youtube</a></li>
              <li><a class="dropdown-item" href="https://github.com/Adil-production">Github</a></li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </nav>
      <br>
      <br>
      <br>
      <br>
      <h1 style="color: #3c995b; margin: 20px;"><strong>Hello,</strong> <span id="name"></span></h1>
      <br>
      <br>
      <nav class="nav nav-pills justify-content-center m-3">
        <a class="nav-link text-success" aria-current="page" href="clientDashboard.html">Client</a>
        <a class="nav-link text-success" href="supplierDashboard.html">Suppliers</a>
        <a class="nav-link active bg-success" href="materialDashboard.html">Materials</a>
      </nav>
      <br>

<div align="center">
<div id="page" align="left">
      <div align="right">
        <button class="btn btn-success m-2" style="display: inline-block;" id="add">Add new row</button><button class="btn btn-outline-success m-2" style="display: inline-block;" id="workontable" onclick="parse()">Work on table</button>
        <button class="btn btn-success m-2" style="display: none;" id="recreate">Recreate table</button><button class="btn btn-outline-success m-2" style="display: none;" id="add2">Add new row</button>
      </div>
      <br>
      <br>
      <div id="informations">
      <h3 style="color: black; font-weight: bold;"><span>Article code</span></h3>
      <br>
      <div id="articleCode" align="center">
        <div class="form-floating mb-3">
          <input type="text"  class="form-control" name="articleCodeValue"  value="">
          <label for="floatingInput">Article code</label>
        </div>
        <br>
      </div>


      <br>
      <br>
      <h3 style="color: black; font-weight: bold;"><span>Category</span></h3>
      <br>
      <div id="category" align="center">
        <div class="form-floating mb-3">
          <input type="text"  class="form-control" name="categoryValue"  value="">
          <label for="floatingInput">Category</label>
        </div>
        <br>
      </div>



      <br>
      <br>
      <h3 style="color: black; font-weight: bold;"><span>Subject Name</span></h3>
      <br>
      <div id="subjectName" align="center">
        <div class="form-floating mb-3 ">
          <input type="text"  class="form-control" name="subjectNameValue"  value="">
          <label for="floatingInput">Subject Name</label>
        </div>
        <br>
      </div>




      <br>
      <br>
      <h3 style="color: black; font-weight: bold;"><span>Unit (Kg)</span></h3>
      <br>
      <div id="unit" align="center">
        <div class="form-floating mb-3 ">
          <input type="text"  class="form-control" name="unitValue"  value="">
          <label for="floatingInput">Unit</label>
        </div>
        <br>
      </div>




      <br>
      <br>
      <h3 style="color: black; font-weight: bold;"><span>Single price</span></h3>
      <br>
      <div id="singlePrice" align="center">
        <div class="form-floating mb-3 ">
          <input type="text"  class="form-control" name="singlePriceValue"  value="">
          <label for="floatingInput">Single price</label>
        </div>
        <br>
      </div>






      <br>
      <br>
      <h3 style="color: black; font-weight: bold; "><span>Entries</span></h3>
      <br>
      <div id="entries" align="center">
        <div class="form-floating mb-3">
          <input type="text"  class="form-control" name="entriesValue"  value="">
          <label for="floatingInput">Entries</label>
        </div>
        <br>
      </div>







      <br>
      <br>
      <h3 style="color: black; font-weight: bold;"><span>Outputs</span></h3>
      <br>
      <div id="outputs" align="center">
        <div class="form-floating mb-3 ">
          <input type="text"  class="form-control" name="outputsValue"  value="">
          <label for="floatingInput">Outputs</label>
        </div>
        <br>
      </div>




      
      <br>
      <br>
      <h3 style="color: black; font-weight: bold;"><span>Existing</span></h3>
      <br>
      <div id="existing" align="center">
        <div class="form-floating mb-3 ">
          <input type="text"  class="form-control" name="existingValue"  value="">
          <label for="floatingInput">Existing</label>
        </div>
        <br>
      </div>







      <div align="right">
        <br>
        <button class="btn btn-success" id="parse" onclick="parse()">Parse</button>
      </div>

</div>
</div>
</div>




      <div id="tableEx">

      </div>

        <br>
        <br>
        <div align="right" id="install" style="display: none;" class="m-3">
          <button class="btn btn-outline-success m-2" id="save">Save</button><button class="btn btn-success m-2" id="download" onclick="ExportToExcel('xlsx')">Download Excel file</button>
        </div>

        <br>
  <br>
  <br>
  <br>
  <br>
  <br>
  <footer class="text-center text-lg-start bg-light text-muted p-3">

    <!-- Section: Social media -->
  
    <!-- Section: Links  -->
    <section class="">
      <div class="container text-center text-md-start mt-5">
        <!-- Grid row -->
        <div class="row mt-3">
          <!-- Grid column -->
          <div class="col-md-3 col-lg-4 col-xl-3 mx-auto mb-4">
            <!-- Content -->
            <h6 class="text-uppercase fw-bold mb-4">
              <i class="fas fa-gem me-3"></i>Porbet
            </h6>
            <p>
              Porbet , a company that makes something out of nothing
            </p>
          </div>
          <!-- Grid column -->
  
          <!-- Grid column -->
          <div class="col-md-2 col-lg-2 col-xl-2 mx-auto mb-4">
            <!-- Links -->
            <h6 class="text-uppercase fw-bold mb-4">
              Products
            </h6>
            <p>
              <a href="https://porbet.github.io/cytocyber/" class="text-reset">Cytocyber</a>
            </p>
            <p>
              <a href="https://porbet.github.io/streamjs/" class="text-reset">Strean.js</a>
            </p>
            <p>
              <a href="https://porbet.github.io/opensource/" class="text-reset">Porbet keep</a>
            </p>
            <p>
              <a href="https://porbet.github.io/opensource/" class="text-reset">Porbet todo</a>
            </p>
          </div>
          <!-- Grid column -->
  
          <!-- Grid column -->
          <div class="col-md-3 col-lg-2 col-xl-2 mx-auto mb-4">
            <!-- Links -->
            <h6 class="text-uppercase fw-bold mb-4">
              Useful links
            </h6>
            <p>
              <a href="index.html" class="text-reset">Home</a>
            </p>
            <p>
              <a href="https://porbet.github.io/store/" class="text-reset">Store</a>
            </p>
            <p>
              <a href="contact.html" class="text-reset">Contact</a>
            </p>
            <p>
              <a href="privacy.html" class="text-reset">Privacy</a>
            </p>
          </div>
          <!-- Grid column -->
  
          <!-- Grid column -->
          <div class="col-md-4 col-lg-3 col-xl-3 mx-auto mb-md-0 mb-4">
            <!-- Links -->
            <h6 class="text-uppercase fw-bold mb-4">
              Contact
            </h6>
            <p><i class="fas fa-home me-3"></i> Nador, Morocco</p>
            <p>
              <i class="fas fa-envelope me-3"></i>
              porbet.contact@gmail.com
            </p>
            <p><i class="fas fa-phone me-3"></i> + 212 638 397 172</p>
          </div>
          <!-- Grid column -->
        </div>
        <!-- Grid row -->
      </div>
    </section>
    <!-- Section: Links  -->
  
    <!-- Copyright -->
    <div class="text-center p-4" >
      © 2022 Copyright:
      <a class="text-reset fw-bold" href="http://opensource-porbet.ga/">opensource-porbet.ga</a>
    </div>
    <!-- Copyright -->
  </footer>
      <script>
        document.getElementById("name").innerHTML = localStorage.getItem("name");

        // Add new row
        document.getElementById("add").addEventListener("click",function(){
          document.getElementById("articleCode").innerHTML += `
          <div class="form-floating mb-3">
            <input type="text"  class="form-control" name="articleCodeValue"  value="">
            <label for="floatingInput">Article code</label>
          </div>
          <br>
          `
          document.getElementById("category").innerHTML += `
          <div class="form-floating mb-3">
            <input type="text"  class="form-control" name="categoryValue"  value="">
            <label for="floatingInput">Category</label>
          </div>
          <br>
          `
          document.getElementById("subjectName").innerHTML += `
          <div class="form-floating mb-3 ">
            <input type="text"  class="form-control" name="subjectNameValue"  value="">
            <label for="floatingInput">Subject Name</label>
          </div>
          <br>
          `
          document.getElementById("unit").innerHTML += `
          <div class="form-floating mb-3 ">
            <input type="text"  class="form-control" name="unitValue"  value="">
            <label for="floatingInput">Unit</label>
          </div>
          <br>
          `
          document.getElementById("singlePrice").innerHTML += `
          <div class="form-floating mb-3 ">
            <input type="text"  class="form-control" name="singlePriceValue"  value="">
            <label for="floatingInput">Single price</label>
          </div>
          <br>
          `
          document.getElementById("entries").innerHTML += `
          <div class="form-floating mb-3">
            <input type="text"  class="form-control" name="entriesValue"  value="">
            <label for="floatingInput">Entries</label>
          </div>
          <br>
          `
          document.getElementById("outputs").innerHTML += `
          <div class="form-floating mb-3 ">
            <input type="text"  class="form-control" name="outputsValue"  value="">
            <label for="floatingInput">Outputs</label>
          </div>
          <br>
          `
          document.getElementById("existing").innerHTML += `
          <div class="form-floating mb-3 ">
            <input type="text"  class="form-control" name="existingValue"  value="">
            <label for="floatingInput">Existing</label>
          </div>
          <br>
          `
        })

        function parse(){
          var articleCode = document.getElementsByName('articleCodeValue');
          var category = document.getElementsByName('categoryValue');
          var subjectName = document.getElementsByName('subjectNameValue');
          var unit = document.getElementsByName('unitValue');
          var singlePrice = document.getElementsByName('singlePriceValue');
          var entries = document.getElementsByName('entriesValue');
          var outputs = document.getElementsByName('outputsValue');
          var existing = document.getElementsByName('existingValue');
          var articleCodeValue = [];
          var categoryValue = [];
          var subjectNameValue = [];
          var unitValue = [];
          var singlePriceValue = [];
          var entriesValue = [];
          var outputsValue = [];
          var existingValue = [];
          for (var i = 0; i < articleCode.length; i++) {
              var a = articleCode[i].value;
              articleCodeValue.push(a);
          }
          for (var i = 0; i < category.length; i++) {
              var a = category[i].value;
              categoryValue.push(a);
          }
          for (var i = 0; i < subjectName.length; i++) {
              var a = subjectName[i].value;
              subjectNameValue.push(a);
          }
          for (var i = 0; i < unit.length; i++) {
              var a = unit[i].value;
              unitValue.push(a);
          }
          for (var i = 0; i < singlePrice.length; i++) {
              var a = singlePrice[i].value;
              singlePriceValue.push(a);
          }
          for (var i = 0; i < entries.length; i++) {
              var a = entries[i].value;
              entriesValue.push(a);
          }
          for (var i = 0; i < outputs.length; i++) {
              var a = outputs[i].value;
              outputsValue.push(a);
          }
          for (var i = 0; i < existing.length; i++) {
              var a = existing[i].value;
              existingValue.push(a);
          }

          console.log(articleCodeValue);
          console.log(categoryValue);
          console.log(subjectNameValue);
          console.log(unitValue);
          console.log(singlePriceValue);
          console.log(entriesValue);
          console.log(outputsValue);
          console.log(existingValue);

        var customers = new Array();
        customers.push(["Article code", "Category", "Subject name", "Unit (kg)", "Single price", "Entries", "Outputs" , "Existing"]);
        for(var i = 0; i < outputsValue.length; i++){
          customers.push([articleCodeValue[i], categoryValue[i] , subjectNameValue[i], unitValue[i], singlePriceValue[i], entriesValue[i], outputsValue[i] , existingValue[i] ]);
        }
        //Create a HTML Table element.
        var table = document.createElement("TABLE");
        table.setAttribute("id","table");
        table.border = "1";
 
        //Get the count of columns.
        var columnCount = customers[0].length;
 
        //Add the header row.
        var row = table.insertRow(-1);
        for (var i = 0; i < columnCount; i++) {
            var headerCell = document.createElement("TH");
            headerCell.innerHTML = customers[0][i];
            row.appendChild(headerCell);
        }
 
        //Add the data rows.
        for (var i = 1; i < customers.length; i++) {
            row = table.insertRow(-1);
            for (var j = 0; j < columnCount; j++) {
                var cell = row.insertCell(-1);
                cell.contentEditable = "true";
                cell.innerHTML = customers[i][j];
            }
        }
 
        var dvTable = document.getElementById("tableEx");
        dvTable.innerHTML = "";
        dvTable.appendChild(table);
        localStorage.setItem("materialTable",document.getElementById("tableEx").innerHTML)



        document.getElementById("informations").style.display = "none";
        document.getElementById("add").style.display = "none";
        document.getElementById("workontable").style.display = "none";
        document.getElementById("recreate").style.display = "inline-block";
        document.getElementById("add2").style.display = "inline-block";
        document.getElementById("install").style.display = "block";

      
        }
        //recreate table
        document.getElementById("recreate").addEventListener("click",function(){
          localStorage.removeItem("materialTable");
          window.location.reload();
        })
        //save table
        document.getElementById("save").addEventListener("click",function(){
          localStorage.setItem("materialTable",document.getElementById("tableEx").innerHTML)
          alert("Saved")
        })
        //add new row table
        document.getElementById("add2").addEventListener("click",function(){
          document.getElementsByTagName("tbody")[0].innerHTML += `
              <tr>
                <td contentEditable="true"></td>
                <td contentEditable="true"></td>
                <td contentEditable="true"></td>
                <td contentEditable="true"></td>
                <td contentEditable="true"></td>
                <td contentEditable="true"></td>
                <td contentEditable="true"></td>
                <td contentEditable="true"></td>
              </tr>
          `
        })



      window.addEventListener('load', (event) => {
          var table = localStorage.getItem("materialTable")
          if(table){
            document.getElementById("informations").style.display = "none";
            document.getElementById("add").style.display = "none";
            document.getElementById("workontable").style.display = "none";
            document.getElementById("tableEx").innerHTML = table;
            document.getElementById("recreate").style.display = "inline-block";
            document.getElementById("add2").style.display = "inline-block";
            document.getElementById("install").style.display = "block";
          } else{
            document.getElementById("informations").style.display = "block";
            document.getElementById("add").style.display = "inline-block";
            document.getElementById("workontable").style.display = "inline-block";
            document.getElementById("recreate").style.display = "none";
            document.getElementById("add2").style.display = "none";
            document.getElementById("install").style.display = "none";
          }
        }); 

        function ExportToExcel(type, fn, dl) {
            var elt = document.getElementById('table');
            var wb = XLSX.utils.table_to_book(elt, { sheet: "material" });
            return dl ?
              XLSX.write(wb, { bookType: type, bookSST: true, type: 'base64' }):
              XLSX.writeFile(wb, fn || (localStorage.getItem("company") + ' material.' + (type || 'xlsx')));
        }


      </script>
</body>
</html>
